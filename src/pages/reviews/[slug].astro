---
import ReviewLayout from "../../layouts/ReviewLayout.astro";
import { reviews } from "../../data/reviews";
import ReviewSummary from "../../layouts/components/ReviewSummary.astro";

export function getStaticPaths() {
    const pages = reviews;

    return pages.map(({ slug, id }) => {
        return {
            params: { slug },
            props: { id }
        }
    })
}

const { slug } = Astro.params;
const { id } = Astro.props;

const review = reviews.filter(r => r.slug == slug)[0]
const ratings = review.rating;

//TODO: add the overal score somewhere
---
<ReviewLayout>
  <div slot='hero' class='h-96 w-full overflow-hidden relative'>
    <div class="grid place-content-center absolute w-full h-full">
      <h2 class="rounded-full m-8 text-4xl bg-mincepiebg-500 p-8">{review.brand} {review.range}</h2>
    </div>
    <img src={review.image} class="object-none object-center min-h-full" />
  </div>


  <div class="gap-2 md:gap-8 flex flex-wrap justify-center mx-4 my-8 sm:mx-4 md:mx-0">
    {Object.keys(ratings).map((rating) =>
      <div class='bg-pie-600 w-full py-2 px-4 text-center md:text-left md:w-auto rounded-full p-2 uppercase text-mincepiebg-500 font-bold'>
        {rating} : {ratings[rating]}
      </div>
    )}
  </div>
  <div class="md:w-5/6 md:m-auto lg:w-1/2 mx-4 text-center bg-pie-600 rounded-full text-mincepiebg-500 py-2 font-bold text-2xl">
    {review.overal} / 20
  </div>
  <div class="gap-8 grid justify-center text-xl mt-8 m-auto w-5/6">
    {review.description}
    <ReviewSummary review={review} />
  </div>
</ReviewLayout>